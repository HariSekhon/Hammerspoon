# Hari Sekhon - Hammerspoon Mac Event-Driven Automation Code

[![GitHub stars](https://img.shields.io/github/stars/HariSekhon/Hammerspoon?logo=github)](https://github.com/HariSekhon/Hammerspoon/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/HariSekhon/Hammerspoon?logo=github)](https://github.com/HariSekhon/Hammerspoon/network)
[![LineCount](https://sloc.xyz/github/HariSekhon/Hammerspoon/?badge-bg-color=2081C2)](https://github.com/boyter/scc/)
[![Cocomo](https://sloc.xyz/github/HariSekhon/Hammerspoon/?badge-bg-color=2081C2&category=cocomo)](https://github.com/boyter/scc/)
[![License](https://img.shields.io/badge/license-MIT-green)](https://github.com/HariSekhon/Hammerspoon/blob/master/LICENSE)
[![My LinkedIn](https://img.shields.io/badge/LinkedIn%20Profile-HariSekhon-blue?logo=data:image/svg%2bxml;base64,PHN2ZyByb2xlPSJpbWciIGZpbGw9IiNmZmZmZmYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+TGlua2VkSW48L3RpdGxlPjxwYXRoIGQ9Ik0yMC40NDcgMjAuNDUyaC0zLjU1NHYtNS41NjljMC0xLjMyOC0uMDI3LTMuMDM3LTEuODUyLTMuMDM3LTEuODUzIDAtMi4xMzYgMS40NDUtMi4xMzYgMi45Mzl2NS42NjdIOS4zNTFWOWgzLjQxNHYxLjU2MWguMDQ2Yy40NzctLjkgMS42MzctMS44NSAzLjM3LTEuODUgMy42MDEgMCA0LjI2NyAyLjM3IDQuMjY3IDUuNDU1djYuMjg2ek01LjMzNyA3LjQzM2MtMS4xNDQgMC0yLjA2My0uOTI2LTIuMDYzLTIuMDY1IDAtMS4xMzguOTItMi4wNjMgMi4wNjMtMi4wNjMgMS4xNCAwIDIuMDY0LjkyNSAyLjA2NCAyLjA2MyAwIDEuMTM5LS45MjUgMi4wNjUtMi4wNjQgMi4wNjV6bTEuNzgyIDEzLjAxOUgzLjU1NVY5aDMuNTY0djExLjQ1MnpNMjIuMjI1IDBIMS43NzFDLjc5MiAwIDAgLjc3NCAwIDEuNzI5djIwLjU0MkMwIDIzLjIyNy43OTIgMjQgMS43NzEgMjRoMjAuNDUxQzIzLjIgMjQgMjQgMjMuMjI3IDI0IDIyLjI3MVYxLjcyOUMyNCAuNzc0IDIzLjIgMCAyMi4yMjIgMGguMDAzeiIvPjwvc3ZnPgo=)](https://www.linkedin.com/in/HariSekhon/)
[![GitHub Last Commit](https://img.shields.io/github/last-commit/HariSekhon/Hammerspoon?logo=github)](https://github.com/HariSekhon/Hammerspoon/commits/master)

[![Codacy](https://app.codacy.com/project/badge/Grade/77e2182854f24d6fbbc64dcc1edcfc84)](https://app.codacy.com/gh/HariSekhon/Hammerspoon/dashboard)
[![CodeFactor](https://www.codefactor.io/repository/github/harisekhon/Hammerspoon/badge)](https://www.codefactor.io/repository/github/harisekhon/Hammerspoon)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Hammerspoon&metric=alert_status)](https://sonarcloud.io/dashboard?id=HariSekhon_Hammerspoon)
[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Hammerspoon&metric=sqale_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Hammerspoon)
[![Reliability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Hammerspoon&metric=reliability_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Hammerspoon)
[![Security Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Hammerspoon&metric=security_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Hammerspoon)

[![Lua](https://img.shields.io/badge/Lua-5-000080?logo=lua&logoColor=white)](#readme)
[![Mac](https://img.shields.io/badge/OS-Mac-blue?logo=apple)](#readme)

[![CI Builds Overview](https://img.shields.io/badge/CI%20Builds-Overview%20Page-blue?logo=circleci)](https://harisekhon.github.io/CI-CD/)
[![Azure DevOps Pipeline](https://dev.azure.com/harisekhon/GitHub/_apis/build/status%2FHammerspoon?branchName=main)](https://dev.azure.com/harisekhon/GitHub/_build/latest?definitionId=16&branchName=main)
[![GitLab Pipeline](https://img.shields.io/badge/GitLab%20CI-legacy-lightgrey?logo=gitlab)](https://gitlab.com/HariSekhon/Hammerspoon/pipelines)
[![BitBucket Pipeline](https://img.shields.io/badge/Bitbucket%20CI-legacy-lightgrey?logo=bitbucket)](https://bitbucket.org/HariSekhon/Hammerspoon/addon/pipelines/home#!/)

[![Repo on GitHub](https://img.shields.io/badge/repo-GitHub-2088FF?logo=github)](https://github.com/HariSekhon/Hammerspoon)
[![Repo on GitLab](https://img.shields.io/badge/repo-GitLab-FCA121?logo=gitlab)](https://gitlab.com/HariSekhon/Hammerspoon)
[![Repo on Azure DevOps](https://img.shields.io/badge/repo-Azure%20DevOps-0078D7?logo=azure%20devops)](https://dev.azure.com/HariSekhon/GitHub/_git/Hammerspoon)
[![Repo on BitBucket](https://img.shields.io/badge/repo-BitBucket-0052CC?logo=bitbucket)](https://bitbucket.org/HariSekhon/Hammerspoon)

[![Markdown](https://github.com/HariSekhon/Hammerspoon/actions/workflows/markdown.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/markdown.yaml)
[![Validation](https://github.com/HariSekhon/Hammerspoon/actions/workflows/validate.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/validate.yaml)
[![Kics](https://github.com/HariSekhon/Hammerspoon/actions/workflows/kics.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/kics.yaml)
[![Grype](https://github.com/HariSekhon/Hammerspoon/actions/workflows/grype.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/grype.yaml)
[![Semgrep](https://github.com/HariSekhon/Hammerspoon/actions/workflows/semgrep.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/semgrep.yaml)
[![Semgrep Cloud](https://github.com/HariSekhon/Hammerspoon/actions/workflows/semgrep-cloud.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/semgrep-cloud.yaml)
[![SonarCloud](https://github.com/HariSekhon/Hammerspoon/actions/workflows/sonarcloud.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/sonarcloud.yaml)
[![Trivy](https://github.com/HariSekhon/Hammerspoon/actions/workflows/trivy.yaml/badge.svg)](https://github.com/HariSekhon/Hammerspoon/actions/workflows/trivy.yaml)

<!-- INDEX_START -->

- [Summary](#summary)
- [Setup](#setup)
  - [Install Hammerspoon](#install-hammerspoon)
    - [Add Hammerspoon Code](#add-hammerspoon-code)
  - [Run Hammerspoon](#run-hammerspoon)
    - [Auto-Start Hammerspoon](#auto-start-hammerspoon)
    - [Allow Desktop Notifications](#allow-desktop-notifications)
- [Automation Code](#automation-code)
  - [Auto-Switch to Multi-Output to Shazam from TV/Movies while listening on headphones](#auto-switch-to-multi-output-to-shazam-from-tvmovies-while-listening-on-headphones)
  - [Auto-run Speed Test when connecting to a Wifi network](#auto-run-speed-test-when-connecting-to-a-wifi-network)

<!-- INDEX_END -->

## Summary

Mac event driven automation using Hammerspoon.

Hammerspoon is a system event handler for Mac.

The code is written in Lua.

Includes:

- [Auto-switching to Multi-Output for Shazaming when connecting headphones](#auto-switching-to-multi-output-for-shazaming-when-connecting-headphones)
- [Automatically running Speed Test when connecting to a wifi network](#automatically-running-speed-test-when-connecting-to-a-wifi-network)

## Setup

### Install Hammerspoon

Install Hammerspoon using Homebrew:

```shell
brew install hammerspoon --cask
```

#### Add Hammerspoon Code

```shell
mkdir -p -v ~/github
```

```shell
git clone https://github.com/HariSekhon/Hammerspoon ~/github/hammerspoon
```

```shell
ln -svFhw ~/github/hammerspoon ~/.hammerspoon
```

Output:

```text
/Users/hari/.hammerspoon/hammerspoon -> /Users/hari/github/hammerspoon
```

### Run Hammerspoon

Finally, start Hammerspoon, you should see its icon in the menu bar.

```shell
open -a Hammerspoon
```

#### Auto-Start Hammerspoon

Set Hammerspoon to start at login (you can tick this in the Hammerspoon Preferences UI) or just run this:

```shell
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/Hammerspoon.app", hidden:false}'
```

#### Allow Desktop Notifications

Optionally allow pop-up desktop notifications from Hammerspoon
so that your code can notify you when it's done something for you
(I recommend Banners that automatically disappear without having to click them).

`System Settings` -> `Notifications` ->`Hammerspoon`:

```shell
open "x-apple.systempreferences:com.apple.Notifications-Settings.extension?bundleId=org.hammerspoon.Hammerspoon"
```

## Automation Code

### Auto-Switch to Multi-Output to Shazam from TV/Movies while listening on headphones

Automatically switches from AirPods connection to Multi-Output Audio Device and Blackhole input
to be able to Shazam songs while watching a movie or TV show on AirPods.

See
[HariSekhon/Knowledge-Base - Audio](https://github.com/HariSekhon/Knowledge-Base/blob/main/audio.md#automatically-switch-to-using-multi-output-device-when-connecting-headphones)
page section for more details.

### Auto-run Speed Test when connecting to a Wifi network

TODO + refactor

## More Core Repos

<!-- OTHER_REPOS_START -->

### Knowledge

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Knowledge-Base&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Knowledge-Base)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Diagrams-as-Code&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Diagrams-as-Code)

<!--

Not support on GitHub Markdown:

<iframe src="https://raw.githubusercontent.com/HariSekhon/HariSekhon/main/knowledge.md" width="100%" height="500px"></iframe>

Does nothing:

<embed src="https://raw.githubusercontent.com/HariSekhon/HariSekhon/main/knowledge.md" width="100%" height="500px" />

-->

### DevOps Code

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=DevOps-Bash-tools&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/DevOps-Bash-tools)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=DevOps-Python-tools&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/DevOps-Python-tools)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=DevOps-Perl-tools&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/DevOps-Perl-tools)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=DevOps-Golang-tools&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/DevOps-Golang-tools)

<!--
[![Gist Card](https://github-readme-stats.vercel.app/api/gist?id=f8f551332440f1ca8897ff010e363e03)](https://gist.github.com/HariSekhon/f8f551332440f1ca8897ff010e363e03)
-->

### Containerization

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Kubernetes-configs&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Kubernetes-configs)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Dockerfiles&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Dockerfiles)

### CI/CD

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=GitHub-Actions&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/GitHub-Actions)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Jenkins&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Jenkins)

### Databases - DBA - SQL

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=SQL-scripts&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/SQL-scripts)

### DevOps Reloaded

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=HAProxy-configs&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/HAProxy-configs)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Terraform&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Terraform)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Packer&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Packer)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Ansible&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Ansible)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Environments&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Environments)

### Monitoring

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Nagios-Plugins&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Nagios-Plugins)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Nagios-Plugin-Kafka&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Nagios-Plugin-Kafka)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Prometheus&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Prometheus)

### Templates

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Templates&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Templates)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Template-repo&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Template-repo)

### Desktop

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=TamperMonkey&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/TamperMonkey)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Hammerspoon&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Hammerspoon)

### Spotify

[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Spotify-tools&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Spotify-tools)
[![Readme Card](https://github-readme-stats.vercel.app/api/pin/?username=HariSekhon&repo=Spotify-playlists&theme=ambient_gradient&description_lines_count=3)](https://github.com/HariSekhon/Spotify-playlists)

The rest of my original source repos are
[here](https://github.com/HariSekhon?tab=repositories&q=&type=source&language=&sort=stargazers).

Pre-built Docker images are available on my [DockerHub](https://hub.docker.com/u/harisekhon/).

<!-- OTHER_REPOS_END -->
